<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Shekhar Portfolio</title>
 
	<!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
	<link rel="shortcut icon" href="../panel/images/logosashwatum.ico">

	<link href="https://fonts.googleapis.com/css?family=Quicksand:300,400,500,700" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Playfair+Display:400,400i,700" rel="stylesheet">
	
	<!-- Animate.css -->
	<link rel="stylesheet" href="css/animate.css">
	<!-- Icomoon Icon Fonts-->
	<link rel="stylesheet" href="css/icomoon.css">
	<!-- Bootstrap  -->
	<link rel="stylesheet" href="css/bootstrap.css">
	<!-- Flexslider  -->
	<link rel="stylesheet" href="css/flexslider.css">
	<!-- Flaticons  -->
	<!-- <link rel="stylesheet" href="fonts/flaticon/font/flaticon.css"> -->
	<!-- Owl Carousel -->
	<link rel="stylesheet" href="css/owl.carousel.min.css">
	<link rel="stylesheet" href="css/owl.theme.default.min.css">
	<!-- Theme style  -->
	<link rel="stylesheet" href="css/style.css">
	<!-- fabric img -->
	<link rel="icon" type="image/x-icon" href="/panel/images/logosashwatum.ico"/>

	<!-- Modernizr JS -->
	<script src="js/modernizr-2.6.2.min.js"></script>
</head>

<body onload="initializeViz();">
  <main class="container mt-5">
    <div id="audio" class="text-center"></div>

    <div id="tableauViz" class="mt-5"></div>
  </main>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="annyang.min.js"></script>
  <script src="responsivevoice.js"></script>
  <script src="https://public.tableausoftware.com/javascripts/api/tableau_v8.debug.js" type="text/javascript"></script>

  <script>
    if (annyang) {
      var commands = {
        'show all': function () {
          startover();
          responsiveVoice.speak('showing all', 'UK English Male');
        },
        'export': function () {
          exportPDF();
          responsiveVoice.speak('exporting', 'UK English Male');
        },
        'start over': function () {
          startover();
          responsiveVoice.speak('starting over', 'UK English Male');
        },
        'Filter Medicine A': function () {
          filterMA();
          responsiveVoice.speak('filtering Medicine A', 'UK English Male');
        },
        'Filter Medicine B': function () {
          filterMB();
          responsiveVoice.speak('filtering Medicine B', 'UK English Male');
        },
        'Filter Medicine C': function () {
          filterMC();
          responsiveVoice.speak('filtering Medicine C', 'UK English Male');
        },
        'Filter Medicine D': function () {
          filterMD();
          responsiveVoice.speak('filtering Medicine D', 'UK English Male');
        },
        'Filter Medicine E': function () {
          filterME();
          responsiveVoice.speak('filtering Medicine E', 'UK English Male');
        },
        'Select Medicine A': function () {
          selectMAS();
          responsiveVoice.speak('selecting Medicine A', 'UK English Male');
        },
        'Select Medicine B': function () {
          selectMBS();
          responsiveVoice.speak('selecting Medicine B', 'UK English Male');
        },
        'Select Medicine C': function () {
          selectMCS();
          responsiveVoice.speak('selecting Medicine C', 'UK English Male');
        },
        'Select Medicine D': function () {
          selectMDS();
          responsiveVoice.speak('selecting Medicine D', 'UK English Male');
        },
        'Select Medicine E': function () {
          selectMES();
          responsiveVoice.speak('selecting Medicine E', 'UK English Male');
        },
        'remove filter': function () {
          removeFilter();
          responsiveVoice.speak('removing filter', 'UK English Male');
        },
      };

      annyang.addCommands(commands);
      annyang.start();
    }

    var viz, workbook, activeSheet, Worksheet, worksheet;

    function initializeViz() {
      var placeholderDiv = document.getElementById("tableauViz");
      var url = "https://public.tableau.com/views/MedicalDashboard/MedicalDashboard?:embed=y&:display_count=yes&:showVizHome=no";
      var options = {
        width: "1004px",
        height: "869px",
        hideTabs: true,
        hideToolbar: true,
        onFirstInteractive: function () {
          workbook = viz.getWorkbook();
          activeSheet = workbook.getActiveSheet();
        }
      };
      viz = new tableauSoftware.Viz(placeholderDiv, url, options);
    }

    responsiveVoice.speak('Hi. My name is Hemang. Welcome to Meeting. How can I help you?', 'UK English Male');

    function showAll() {
      activeSheet.getWorksheets()[1].applyFilterAsync("Year", "", tableauSoftware.FilterUpdateType.REPLACE);
      activeSheet.getWorksheets()[0].applyFilterAsync("Medicine Name", "", tableauSoftware.FilterUpdateType.REPLACE);
    }

    function selectMAS() {
      activeSheet.getWorksheets()[0].selectMarksAsync('Medicine Name', 'Medicine A', 'REPLACE');
    }

    function selectMBS() {
      activeSheet.getWorksheets()[0].selectMarksAsync('Medicine Name', 'Medicine B', 'REPLACE');
    }

    function selectMCS() {
      activeSheet.getWorksheets()[0].selectMarksAsync('Medicine Name', 'Medicine C', 'REPLACE');
    }

    function selectMDS() {
      activeSheet.getWorksheets()[0].selectMarksAsync('Medicine Name', 'Medicine D', 'REPLACE');
    }

    function selectMES() {
      activeSheet.getWorksheets()[0].selectMarksAsync('Medicine Name', 'Medicine E', 'REPLACE');
    }

    function filterMA() {
      activeSheet.getWorksheets()[0].applyFilterAsync('Medicine Name', 'Medicine A', tableauSoftware.FilterUpdateType.REPLACE);
    }

    function filterMB() {
      activeSheet.getWorksheets()[0].applyFilterAsync('Medicine Name', 'Medicine B', tableauSoftware.FilterUpdateType.REPLACE);
    }

    function filterMC() {
      activeSheet.getWorksheets()[0].applyFilterAsync('Medicine Name', 'Medicine C', tableauSoftware.FilterUpdateType.REPLACE);
    }

    function filterMD() {
      activeSheet.getWorksheets()[0].applyFilterAsync('Medicine Name', 'Medicine D', tableauSoftware.FilterUpdateType.REPLACE);
    }

    function filterME() {
      activeSheet.getWorksheets()[0].applyFilterAsync('Medicine Name', 'Medicine E', tableauSoftware.FilterUpdateType.REPLACE);
    }

    function removeFilter() {
      activeSheet.getWorksheets()[0].applyFilterAsync('Medicine Name', ['Medicine A', 'Medicine B', 'Medicine C', 'Medicine D'], tableauSoftware.FilterUpdateType.ALL);
    }

    function exportPDF() {
      viz.showExportPDFDialog();
    }

    function startover() {
      viz.revertAllAsync();
    }
  </script>
</body>

</html>
